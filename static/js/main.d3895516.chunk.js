(this["webpackJsonpgame-ranking"]=this["webpackJsonpgame-ranking"]||[]).push([[0],{275:function(e,t,a){},277:function(e,t,a){},278:function(e,t,a){},283:function(e,t,a){},284:function(e,t,a){},288:function(e,t,a){},289:function(e,t,a){},290:function(e,t,a){},291:function(e,t,a){},292:function(e,t,a){},293:function(e,t,a){},294:function(e,t,a){},295:function(e,t,a){},296:function(e,t,a){},297:function(e,t,a){},298:function(e,t,a){},299:function(e,t,a){},300:function(e,t,a){},301:function(e,t,a){},302:function(e,t,a){},303:function(e,t,a){},304:function(e,t,a){},425:function(e,t,a){},426:function(e,t,a){},427:function(e,t,a){},428:function(e,t,a){},429:function(e,t,a){},431:function(e,t,a){},432:function(e,t,a){},466:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),s=a.n(c),i=(a(275),a(21)),l=a(93),o=a.n(l),u=a(224),d=a(14),j=(a(277),a(278),a(497)),m=a(501),f=a(1),b=function(e){return Object(f.jsxs)("header",{children:[Object(f.jsx)("div",{children:Object(f.jsx)("h1",{children:"Game Ranking"})}),Object(f.jsxs)("div",{className:"header-right",children:[Object(f.jsx)("div",{className:"header-icon-button",onClick:function(){return e.setSettingsOpen(!0)},children:Object(f.jsx)(j.a,{fontSize:"large"})}),Object(f.jsx)("div",{className:"header-icon-button",onClick:function(){return e.setPlayersOpen(!0)},children:Object(f.jsx)(m.a,{fontSize:"large"})}),Object(f.jsx)("div",{className:"today-date",children:(new Date).toLocaleDateString()})]})]})};a(283);function h(e){Object(n.useEffect)((function(){e.notification.open&&setTimeout((function(){e.setNotification({open:!1})}),3e3)}),[e.notification.open]);var t=e.notification.severity?e.notification.severity:"info";return e.notification.open?Object(f.jsx)("div",{className:"notification ".concat(e.notification.open?"open":"close"),children:Object(f.jsx)("div",{className:"notification-content ".concat(t),children:e.notification.text})}):Object(f.jsx)(f.Fragment,{})}var p=function(e,t){return e.filter((function(e){return e.uuid===t}))[0]},O=function(e,t){return e.filter((function(e){return e.uuid===t}))[0]},g=function(e){return e.username.length>1?e.username[0].toUpperCase()+e.username[1]:e.username[0].toUpperCase()},x=function(e){if(!e.results)return[];var t=[];t.push({resultUuid:"",playersRank:[]}),t[0].playersRank=e.players.map((function(e){return{playerUuid:e.uuid,score:1200,deltaScore:0}}));var a=t[0],n={};return e.results.sort((function(e,t){return e.date>=t.date?1:-1})).forEach((function(r){var c=y(r,a,n,e.algorithmSettings);t.push(c),a=c})),t},y=function(e,t,a,n){var r={resultUuid:e.uuid,playersRank:[]};t.playersRank.forEach((function(e){r.playersRank.push({playerUuid:e.playerUuid,score:e.score,deltaScore:e.deltaScore})}));for(var c={},s=function(t){c[t+1]=e.ranks.filter((function(e){return t+1===e.rank})).length},i=0;i<e.ranks.length;i++)s(i);return e.ranks.forEach((function(c){a[c.uuid]||(a[c.uuid]=0);var s=e.ranks.filter((function(e){return c.rank!==e.rank})),i=v(c.uuid,r),l=t.playersRank[v(c.uuid,t)].score,o=0,u=n.params,d=function(e,t,a,n){return n<t?e:a}(u.k_first,u.n_first,u.k,a[c.uuid]);s.forEach((function(e){var a,n,r=t.playersRank[v(e.uuid,t)].score,s=c.rank<e.rank?1:0,i=(a=l,n=r,1/(1+Math.pow(10,(n-a)/400))),u=function(e,t,a,n){return e+n*(a-t)/(arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)}(l,i,s,d);o+=u-l})),r.playersRank[i].score=l+o,r.playersRank[i].deltaScore=o,a[c.uuid]+=1})),r},v=function(e,t){return t.playersRank.findIndex((function(t){return t.playerUuid===e}))},k=function(e){var t=[];return e.forEach((function(e){return t.push(N(e))})),t},N=function(e){var t={};return t.resultUuid=e.resultUuid,e.playersRank.forEach((function(e){return t[e.playerUuid]=Math.round(e.score)})),t},S=function(e){var t={gamename:e.gamename,uuid:e.uuid,players:[],results:[],rankHistory:[],algorithmSettings:e.algorithmSettings};if(t.algorithmSettings||(t.algorithmSettings={algo:"elo",params:{k_first:40,n_first:5,k:25}}),e.results.forEach((function(e){var a=e;a.date=new Date(a.date),t.results.push(a),a.ranks.forEach((function(e){var a;t.players?t.players.some((function(t){return t.uuid===e.uuid}))||null===(a=t.players)||void 0===a||a.push({uuid:e.uuid,rank:0}):t.players=[{uuid:e.uuid,rank:0}]}))})),t.rankHistory=x(t),t.players){var a=t.players.sort((function(e,t){return e.rank>t.rank?1:-1}));t.players=a}return t},C=function(e){var t=[];return e.results.forEach((function(e){e.ranks.forEach((function(e){t.some((function(t){return t.uuid===e.uuid}))||t.push({uuid:e.uuid,rank:0})}))})),t},R=(a(284),a(226)),w=a.n(R),D=a(86);a(288);function E(e){return Object(f.jsx)("div",{className:"game-card add-game",onClick:function(){return function(){var t={uuid:Object(D.uuid)(),gamename:"New game",results:[],players:[],rankHistory:[],algorithmSettings:{algo:"elo",params:{k_first:40,n_first:5,k:25}}};e.setGames([t].concat(e.games)),e.setCurrentGame({game:t,edit:!0})}()},children:Object(f.jsx)(w.a,{className:"add-game-icon"})})}a(289),a(290);var P=function(e){return Object(f.jsx)("div",{className:"avatar",style:{backgroundColor:e.color},children:Object(f.jsx)("div",{className:"avatar-label",children:e.label})})},_=(a(291),function(e){return Object(f.jsxs)("div",{className:"avatar-group",children:[e.children.slice(0,e.max).map((function(e,t){return Object(f.jsx)("div",{className:"avatar-group-avatar",children:e},t)})),e.children.length>e.max&&Object(f.jsxs)("div",{className:"avatar-group-avatar-more",children:["+",e.children.length-e.max]})]})}),F=function(e){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"game-card ".concat(e.active?"active":""),onClick:function(){e.active?e.setCurrentGame({game:void 0,edit:!1}):e.setCurrentGame({game:e.game,edit:!1})},children:!e.active&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{children:e.game.gamename}),Object(f.jsx)("div",{className:"game-card-stats",children:0===e.game.rankHistory.length?Object(f.jsx)("div",{}):Object(f.jsx)(_,{max:3,children:e.game.rankHistory[e.game.rankHistory.length-1].playersRank.sort((function(e,t){return e.score<t.score?1:-1})).map((function(t,a){var n=p(e.players,t.playerUuid);return Object(f.jsx)(P,{label:g(n),color:n.color},a)}))})})]})}),Object(f.jsx)("div",{className:"game-card-outside-name-container ".concat(e.active?"active":""),children:Object(f.jsx)("div",{className:"game-card-outside-name",children:e.game.gamename})})]})},G=(a(292),a(505)),M=a(513),A=a(503),I=a(504),U=a(506),H=a(250);a(293);function B(e){var t,a=function(t){return 0!==e.selectedPlayers.filter((function(e){return e.uuid===t})).length};return Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Who was playing?"}),Object(f.jsx)("div",{className:"games-add-result-who-players",children:(t=e.players,t.map((function(t){return Object(f.jsxs)("div",{className:"games-add-result-who-player ".concat(a(t.uuid)?"selected":""),onClick:function(){return n=t.uuid,void(a(n)?e.setSelectedPlayers(e.selectedPlayers.filter((function(e){return e.uuid!==n}))):e.setSelectedPlayers([].concat(Object(H.a)(e.selectedPlayers),[{uuid:n,rank:1}])));var n},children:[Object(f.jsx)(P,{color:t.color,label:g(t)}),Object(f.jsx)("p",{children:t.username})]})})))})]})}var L=a(248),z=a(32),K=a(519);a(294);function T(e){return Object(f.jsxs)("div",{className:"game-add-result-when",children:[Object(f.jsx)("p",{children:"When?"}),Object(f.jsx)(z.a,{utils:L.a,children:Object(f.jsx)(K.a,{value:e.selectedDate,onChange:function(t){e.setSelectedDate(t)},showTodayButton:!0,format:"dd/MM/yyyy HH:mm"})})]})}a(295),a(296);function J(e){return Object(f.jsxs)("div",{className:"select-container",children:[e.label&&Object(f.jsx)("label",{children:e.label}),Object(f.jsx)("select",{defaultValue:e.defaultValue,onChange:e.onChange,children:e.options.map((function(e,t){return Object(f.jsx)("option",{value:e.value,children:e.label},t)}))})]})}function V(e){var t;return Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Ranks"}),Object(f.jsx)("div",{className:"game-add-result-ranks-players",children:(t=e.selectedPlayers,t.map((function(a,n){var r={gridRow:"".concat(n+1,"/").concat(n+2),gridColumn:"1/2"};return Object(f.jsxs)("div",{className:"game-add-result-ranks-player",style:r,children:[Object(f.jsx)("div",{children:Object(f.jsx)(P,{label:g(p(e.players,a.uuid)),color:p(e.players,a.uuid).color})}),Object(f.jsx)("div",{children:p(e.players,a.uuid).username}),Object(f.jsx)("div",{className:"game-add-result-ranks-player-rank",children:Object(f.jsx)(J,{onChange:function(t){return function(t,a){var n=e.selectedPlayers;n.map((function(e){return e.uuid===a?e.rank=t.target.value:e})),e.setSelectedPlayers(n)}(t,a.uuid)},defaultValue:a.rank,options:t.map((function(e,t){return{value:"".concat(t+1),label:"".concat(t+1)}}))})})]},a.uuid)})))})]})}a(297);function W(e){return Object(f.jsxs)("button",{className:"button ".concat(e.className),onClick:function(){return e.onClick()},disabled:e.disabled,type:e.type,style:e.style,children:[e.startIcon,e.text,e.endIcon]})}var Y=a(502),q=(a(298),function(e){return Object(f.jsx)("button",{className:"icon-button ".concat(e.className),onClick:function(){return e.onClick()},disabled:e.disabled,children:e.icon})}),Q=(a(299),function(e){return Object(f.jsx)("div",{className:"dialog ".concat(e.open?"open":""),children:Object(f.jsxs)("div",{className:"dialog-content",children:[Object(f.jsxs)("div",{className:"dialog-header",children:[Object(f.jsx)(q,{onClick:e.onClose,icon:Object(f.jsx)(Y.a,{})}),Object(f.jsx)("h3",{className:"dialog-title",children:e.title})]}),Object(f.jsx)("div",{className:"dialog-body",children:e.content}),e.actions&&Object(f.jsx)("div",{className:"dialog-actions",children:e.actions})]})})});function X(e){return Object(f.jsx)(Q,{open:!0,onClose:function(){return e.setDeleteResultOpen(!1)},title:"Delete this Result?",content:Object(f.jsx)("p",{children:"This will delete this Result and all associated results"}),actions:[Object(f.jsx)(W,{onClick:function(){return e.setDeleteResultOpen(!1)},text:"Cancel"}),Object(f.jsx)(W,{onClick:function(){return e.deleteResult()},style:{color:"#DD0505",borderColor:"#DD0505"},text:"delete"})]})}a(300);var Z=function(e){return Object(f.jsx)("div",{className:"button-group",children:e.children})};function $(e){var t=r.a.useState("who"),a=Object(d.a)(t,2),n=a[0],c=a[1],s=r.a.useState(e.addResultOpen.id?e.game.results.filter((function(t){return t.uuid===e.addResultOpen.id}))[0].date:new Date),i=Object(d.a)(s,2),l=i[0],o=i[1],u=r.a.useState(e.addResultOpen.id?e.game.results.filter((function(t){return t.uuid===e.addResultOpen.id}))[0].ranks:[]),j=Object(d.a)(u,2),m=j[0],b=j[1],h=r.a.useState(!1),O=Object(d.a)(h,2),g=O[0],x=O[1],y=e.addResultOpen.id?"Edit result":"Add result";return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(Q,{open:e.addResultOpen.open,title:y,content:"who"===n?Object(f.jsx)(B,{players:e.players,setSelectedPlayers:b,selectedPlayers:m}):"when"===n?Object(f.jsx)(T,{setSelectedDate:o,selectedDate:l}):"ranks"===n?Object(f.jsx)(V,{players:e.players,setSelectedPlayers:b,selectedPlayers:m}):Object(f.jsx)("p",{children:"ERROR"}),actions:Object(f.jsxs)(Z,{children:[Object(f.jsx)(W,{onClick:function(){return e.setAddResultOpen({id:void 0,open:!1})},text:"Cancel"}),e.addResultOpen.id&&Object(f.jsx)(W,{onClick:function(){return x(!0)},startIcon:Object(f.jsx)(A.a,{})}),Object(f.jsx)(W,{disabled:"who"===n,onClick:function(){"when"===n?c("who"):"ranks"===n&&c("when")},startIcon:Object(f.jsx)(I.a,{})}),"ranks"===n?Object(f.jsx)(W,{onClick:function(){return function(){var t=0,a=!1;if(m.forEach((function(e){0===t&&(t=e.rank),t!==e.rank&&(a=!0)})),a){var n=m.sort((function(e,t){return e.rank>t.rank?1:-1}));b(n);var r={date:l,ranks:m,uuid:Object(D.uuid)()};e.addResultOpen.id?e.addNotification("Result correctly edited","success"):e.addNotification("New result correctly added","success"),e.setAddResultOpen({id:void 0,open:!1}),e.addResult(r,e.addResultOpen.id)}else e.addNotification("Results need at least two different rank","error")}()},endIcon:Object(f.jsx)(G.a,{}),text:"Send"}):Object(f.jsx)(W,{onClick:function(){return function(){if("who"===n)if(m.length<2)e.addNotification("Please select a least 2 players","error");else{c("when");var t=m.sort((function(t,a){return p(e.players,t.uuid).username>p(e.players,a.uuid).username?1:-1}));b(t)}else"when"===n&&c("ranks")}()},startIcon:Object(f.jsx)(U.a,{})})]}),onClose:function(){return e.setAddResultOpen({id:void 0,open:!1})}}),g&&Object(f.jsx)(X,{setDeleteResultOpen:x,deleteResult:function(){x(!1),e.setAddResultOpen({id:void 0,open:!1}),e.deleteResult(e.addResultOpen.id)}})]})}a(301);var ee=a(507);a(302);function te(e){var t,a="".concat(Math.round(e.score)),n="";return e.deltaScore&&(a=e.score<0?"".concat(Math.round(e.score)):"+".concat(Math.round(e.score)),n=e.score<0?"delta-negative":"delta-positive"),Object(f.jsxs)("div",{className:"score-chip ".concat(n),children:[(t=e.rank,e.deltaScore?Object(f.jsx)(f.Fragment,{}):1===t?Object(f.jsx)(ee.a,{className:"first",fontSize:"small"}):2===t?Object(f.jsx)(ee.a,{className:"second",fontSize:"small"}):3===t?Object(f.jsx)(ee.a,{className:"third",fontSize:"small"}):Object(f.jsx)(f.Fragment,{})),a]})}var ae=function(e){return Object(f.jsxs)("div",{className:"result-card",onClick:function(){return e.setAddResultOpen({id:e.result.uuid,open:!0})},children:[Object(f.jsx)("div",{className:"result-card-players",children:e.result.ranks.map((function(t){var a=e.playersRank.filter((function(e){return e.playerUuid===t.uuid}))[0];return"".concat(p(e.players,t.uuid).username," - New score: ").concat(Math.round(a.score)),Object(f.jsxs)("div",{className:"result-card-player",children:[Object(f.jsx)(te,{rank:t.rank,score:a.deltaScore,deltaScore:!0}),Object(f.jsx)(P,{label:g(p(e.players,t.uuid)),color:p(e.players,t.uuid).color}),Object(f.jsxs)("div",{className:"result-card-rank",children:["#",t.rank]})]})}))}),Object(f.jsx)("p",{children:e.result.date.toLocaleString()})]})};function ne(e){return Object(f.jsx)(Q,{open:!0,onClose:function(){return e.setDeleteGameOpen(!1)},title:"Delete this game?",content:Object(f.jsx)("p",{children:"This will delete this game and all associated results."}),actions:[Object(f.jsx)(W,{onClick:function(){return e.setDeleteGameOpen(!1)},text:"Cancel"}),Object(f.jsx)(W,{onClick:function(){return e.deleteGame()},style:{color:"#DD0505",borderColor:"#DD0505"},text:"Delete"})]})}a(303);function re(e){return Object(f.jsxs)("div",{className:"input-container",children:[e.label&&Object(f.jsx)("label",{children:e.label}),Object(f.jsx)("input",{type:e.type,value:e.value,onChange:e.onChange})]})}function ce(e){var t=r.a.useState(e.currentGame),a=Object(d.a)(t,2),n=a[0],c=a[1];return Object(f.jsx)(Q,{open:!0,onClose:function(){return e.setEditMode(!1)},title:"Change the game settings",actions:[Object(f.jsx)(W,{onClick:function(){return e.setEditMode(!1)},text:"Cancel"}),Object(f.jsx)(W,{onClick:function(){e.handleChangeGame(n),e.setEditMode(!1)},style:{color:"#0DF505",borderColor:"#0DF505"},text:"Update"})],content:Object(f.jsxs)("div",{className:"vertical-centered gap-10",children:[Object(f.jsx)(re,{label:"Game name",value:n.gamename,onChange:function(e){return c(Object(i.a)(Object(i.a)({},n),{},{gamename:e.target.value}))}}),Object(f.jsx)(J,{label:"Algorithm",defaultValue:n.algorithmSettings.algo,onChange:function(){},options:[{value:"elo",label:"elo"}]}),Object(f.jsx)(re,{label:"K factor for n first games",type:"number",value:n.algorithmSettings.params.k_first,onChange:function(e){return c(Object(i.a)(Object(i.a)({},n),{},{algorithmSettings:Object(i.a)(Object(i.a)({},n.algorithmSettings),{},{params:Object(i.a)(Object(i.a)({},n.algorithmSettings.params),{},{k_first:Number(e.target.value)})})}))}}),Object(f.jsx)(re,{label:"N",type:"number",value:n.algorithmSettings.params.n_first,onChange:function(e){return c(Object(i.a)(Object(i.a)({},n),{},{algorithmSettings:Object(i.a)(Object(i.a)({},n.algorithmSettings),{},{params:Object(i.a)(Object(i.a)({},n.algorithmSettings.params),{},{n_first:Number(e.target.value)})})}))}}),Object(f.jsx)(re,{label:"K factor after n first games",type:"number",value:n.algorithmSettings.params.k,onChange:function(e){return c(Object(i.a)(Object(i.a)({},n),{},{algorithmSettings:Object(i.a)(Object(i.a)({},n.algorithmSettings),{},{params:Object(i.a)(Object(i.a)({},n.algorithmSettings.params),{},{k:Number(e.target.value)})})}))}})]})})}a(304);var se=a(251),ie=a(511),le=a(512),oe=a(240),ue=a(241),de=a(111),je=a(107),me=a(137);function fe(e){var t,a=function(e,t){var a={},n={};return e.forEach((function(e){t&&e.uuid===t?(a[e.uuid]=1,n[e.uuid]=4):t?(a[e.uuid]=.7,n[e.uuid]=2):(a[e.uuid]=1,n[e.uuid]=2)})),{opacity:a,width:n}},r=Object(n.useState)(a(e.game.players,"")),c=Object(d.a)(r,2),s=c[0],i=c[1],l=function(t,a,n){var r=t.playersRank.filter((function(e){return e.playerUuid===a}))[0],c=p(e.players,a);if(n){var s=r.deltaScore<0?"#FF2020":"#10FFB0",i=r.deltaScore<0?"".concat(Math.round(r.deltaScore)):"+".concat(Math.round(r.deltaScore));return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"linechart-tooltip-score player",style:{backgroundColor:c.color,color:"#FFFFFF"},children:c.username}),Object(f.jsx)("div",{className:"linechart-tooltip-score score",children:Math.round(r.score)}),Object(f.jsxs)("div",{className:"linechart-tooltip-score delta-score",style:{color:s},children:["(",i,")"]})]})}return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"linechart-tooltip-score player",style:{borderColor:c.color,color:"#FFFFFF"},children:c.username}),Object(f.jsx)("div",{className:"linechart-tooltip-score score",children:Math.round(r.score)}),Object(f.jsx)("div",{className:"linechart-tooltip-score delta-score"})]})},o=function(t,a){var n=e.game.rankHistory.filter((function(e){return e.resultUuid===t.uuid}))[0],r=[],c=[];return t.ranks.forEach((function(e){return r.push(e.uuid)})),e.game.players.filter((function(e){return r.indexOf(e.uuid)<=-1})).forEach((function(e){return c.push(e.uuid)})),[r.map((function(e){return l(n,e,!0)})),c.map((function(e){return l(n,e,!1)}))]};e.game.rankHistory.length>25&&e.game.rankHistory.length,e.game.rankHistory.length;return e.game.rankHistory.length&&e.game.players.length?Object(f.jsx)("div",{style:{width:"100%"},children:Object(f.jsx)(ie.a,{width:"100%",height:400,children:Object(f.jsxs)(le.a,{height:400,data:k(e.game.rankHistory),margin:{top:20,right:20,left:20,bottom:20},children:[Object(f.jsx)(oe.a,{dataKey:"resultUuid",tick:!1,axisLine:{stroke:"#fefefe"}}),Object(f.jsx)(ue.a,{yAxisId:1,domain:["dataMin - 50","dataMax + 50"],tick:{fill:"#fefefe"},axisLine:{stroke:"#fefefe"}}),Object(f.jsx)(de.a,{content:function(t){var a=t.active,n=t.payload,r=t.label;return a&&n&&n.length&&r?Object(f.jsxs)("div",{className:"linechart-tooltip",children:[Object(f.jsx)("p",{children:r?O(e.game.results,r).date.toLocaleString():"Start"}),Object(f.jsx)("div",{className:"linechart-tooltip-scores",children:o(O(e.game.results,r))})]}):null}}),Object(f.jsx)(je.a,{verticalAlign:"top",content:function(){return Object(f.jsx)("div",{className:"linechart-result-legend",children:e.game.rankHistory[e.game.rankHistory.length-1].playersRank.sort((function(e,t){return e.score<t.score?1:-1})).map((function(t,n){var r=p(e.players,t.playerUuid);return Object(f.jsxs)("div",{className:"linechart-result-legend-player rank-".concat(n+1),onMouseEnter:function(){return n=t.playerUuid,void i(a(e.game.players,n));var n},onMouseLeave:function(){i(a(e.game.players,""))},children:[Object(f.jsx)(te,{rank:n+1,score:t.score,deltaScore:!1}),Object(f.jsx)(P,{color:r.color,label:g(r)})]},n)}))})}}),(t=e.game.players,t.map((function(t){return Object(f.jsx)(se.a,{type:"natural",strokeWidth:s.width[t.uuid],strokeOpacity:s.opacity[t.uuid],dataKey:t.uuid,stroke:p(e.players,t.uuid).color,yAxisId:1,dot:!1},t.uuid)}))).flat(),Object(f.jsx)(me.a,{height:30,stroke:"#091011"})]})})}):Object(f.jsx)(f.Fragment,{})}function be(e){var t=r.a.useState({id:void 0,open:!1}),a=Object(d.a)(t,2),n=a[0],c=a[1],s=r.a.useState(e.edit),i=Object(d.a)(s,2),l=i[0],o=i[1],u=r.a.useState(!1),j=Object(d.a)(u,2),m=j[0],b=j[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"game-complete-card-container",children:Object(f.jsxs)("div",{className:"game-complete-card",children:[Object(f.jsxs)("div",{className:"game-complete-card-header",children:[Object(f.jsxs)("div",{className:"game-complete-card-general-stats",children:[Object(f.jsxs)("div",{children:[e.game.results.length," results"]}),Object(f.jsxs)("div",{children:[e.game.players.length," players"]}),Object(f.jsxs)("div",{children:["algo: ",e.game.algorithmSettings.algo]})]}),Object(f.jsx)("div",{className:"game-complete-card-general-gamename",children:e.game.gamename}),Object(f.jsxs)("div",{className:"game-complete-card-general-actions",children:[Object(f.jsx)(W,{endIcon:Object(f.jsx)(G.a,{}),onClick:function(){e.players.length<2?e.addNotification("You must add at least 2 players before","error"):c({id:void 0,open:!0})},text:"New result"}),Object(f.jsx)(W,{onClick:function(){return o(!0)},endIcon:Object(f.jsx)(M.a,{})}),Object(f.jsx)(W,{onClick:function(){return b(!0)},endIcon:Object(f.jsx)(A.a,{})})]})]}),e.game.players&&Object(f.jsx)("div",{className:"game-complete-card-stats",children:Object(f.jsx)(fe,{players:e.players,game:e.game})}),n.open?Object(f.jsx)($,{game:e.game,players:e.players,addResultOpen:n,setAddResultOpen:c,addNotification:e.addNotification,addResult:function(t,a){var n=Object.assign({},e.game);if(n.results?a&&(n.results=n.results.filter((function(e){return e.uuid!==a}))):n.results=[],n.results.push(t),n.players=C(n),n.rankHistory=x(n),n.players){var r=n.players.sort((function(e,t){return e.rank>t.rank?1:-1}));n.players=r}e.changeGameData(n,e.game.uuid)},deleteResult:function(t){var a=Object.assign({},e.game);a.results=a.results.filter((function(e){return e.uuid!==t})),a.players=C(a),a.rankHistory=x(a),e.addNotification("Result correctly deleted","success"),e.changeGameData(a,e.game.uuid)}}):Object(f.jsx)(f.Fragment,{})]})}),Object(f.jsx)("div",{className:"game-complete-card-results",children:function(){if(e.game.results)return e.game.results.sort((function(e,t){return e.date<t.date?1:-1})).map((function(t){var a=e.game.rankHistory.filter((function(e){return e.resultUuid===t.uuid}))[0].playersRank;return Object(f.jsx)(ae,{result:t,players:e.players,setAddResultOpen:c,playersRank:a})}))}()}),m&&Object(f.jsx)(ne,{setDeleteGameOpen:b,deleteGame:function(){e.addNotification("Game correctly deleted","success"),b(!1),e.deleteGame(e.game.uuid)}}),l&&Object(f.jsx)(ce,{setEditMode:o,handleChangeGame:function(t){var a=Object.assign({},t);if(a.rankHistory=x(a),a.players){var n=a.players.sort((function(e,t){return e.rank>t.rank?1:-1}));a.players=n}e.changeGameData(a,e.game.uuid),e.addNotification("Game correctly edited","success")},currentGame:e.game})]})}function he(e){var t,a=Object(n.useState)({game:void 0,edit:!1}),r=Object(d.a)(a,2),c=r[0],s=r[1],i=function(t,a){var n=e.games;n.map((function(e){return e.uuid===a?Object.assign(e,t):e})),e.setGames(n)};return Object(f.jsxs)("div",{className:"games-container",children:[Object(f.jsxs)("div",{className:"games",children:[Object(f.jsx)(E,{games:e.games,setGames:e.setGames,setCurrentGame:s}),(t=e.games,t.map((function(t){return Object(f.jsx)(F,{game:t,changeGameData:i,setCurrentGame:s,players:e.players,active:c.game===t})})))]}),c.game&&Object(f.jsx)(be,{game:c.game,edit:!1,changeGameData:i,setCurrentGame:s,players:e.players,deleteGame:function(t){var a=e.games.filter((function(e){return e.uuid!==t}));s({game:void 0,edit:!1}),e.setGames(a),e.addNotification("Game correctly deleted","success")},addNotification:e.addNotification})]})}var pe=a(77),Oe=a.n(pe);a(425);function ge(e){return Object(f.jsxs)("div",{className:"about",children:[Object(f.jsx)("h2",{children:"About..."}),Object(f.jsxs)("section",{children:[Object(f.jsx)("h3",{children:"the author"}),Object(f.jsxs)("p",{children:["Made with love by ",Object(f.jsx)("a",{href:"https://github.com/StephaneBranly",target:"_blank",children:"@stephane_branly"}),"."]})]}),Object(f.jsxs)("section",{children:[Object(f.jsx)("h3",{children:"the project"}),Object(f.jsxs)("p",{children:["Project made for personal use first. But feel free to use it and to give feedback (positive or negative). You can add ",Object(f.jsx)("a",{href:"https://github.com/StephaneBranly/game-ranking/issues",target:"_blank",children:"issues"})," if you want."]})]}),Object(f.jsx)("section",{children:Object(f.jsxs)(Oe.a.Provider,{children:[Object(f.jsx)("h3",{children:"the algorithm"}),Object(f.jsxs)("p",{children:["Currently, the ",Object(f.jsx)("a",{href:"https://en.wikipedia.org/wiki/Elo_rating_system",target:"_blank",children:"ELO"})," algorithm is used."]}),Object(f.jsx)(Oe.a.Node,{formula:"E_{A} = \\frac{1}{1+10^{(R_{B} - R_{A}) / 400}}, E_{B} = \\frac{1}{1+10^{(R_{A} - R_{B}) / 400}}"}),Object(f.jsx)(Oe.a.Node,{formula:"R'_{A} = R_{A} + K(S_{A} - E_{A}), R'_{B} = R_{B} + K(S_{B} - E_{B})"}),Object(f.jsx)(Oe.a.Node,{formula:"E (expected), R (rank), K (factor = 32), S (score : 1=win, 0=loss)"}),Object(f.jsx)("p",{children:"It is adapted to work with more than 2 players and more than 2 teams."}),Object(f.jsx)(Oe.a.Node,{formula:"E_{P,o} = \\frac{1}{1+10^{(R_{o} - R_{P}) / 400}}"}),Object(f.jsx)(Oe.a.Node,{formula:"R'_{P} = R_{P} + \\sum_{i}{K(S_{A} - E_{P,i})},\\ i \\in opponents(P)"}),Object(f.jsx)("p",{children:"If the project grows, new algorithms can be added and parameterized on the interface."})]})})]})}var xe=a(514),ye=a(515),ve=a(516),ke=a(517),Ne=a(518);a(426);function Se(e){var t,a;return Object(f.jsx)("div",{className:"menu ".concat(e.open?"open":""),style:{top:null===(t=e.anchorEl)||void 0===t?void 0:t.offsetTop,left:null===(a=e.anchorEl)||void 0===a?void 0:a.offsetLeft},onMouseLeave:function(){return e.onClose&&e.onClose()},children:e.children})}a(427);function Ce(e){return Object(f.jsxs)("div",{className:"menu-item ".concat(e.className),onClick:function(){return e.onClick&&e.onClick()},children:[e.icon,Object(f.jsx)("span",{children:e.text})]})}a(428);function Re(e){return Object(f.jsx)("div",{className:"separator ".concat(e.className)})}function we(e){var t,a=r.a.useState(!1),n=Object(d.a)(a,2),c=n[0],s=n[1],i=r.a.useRef(null);return Object(f.jsxs)("div",{className:"settings-header",children:[Object(f.jsxs)(Se,{open:c,onClose:function(){s(!1)},anchorEl:null!==(t=i.current)&&void 0!==t?t:void 0,children:[Object(f.jsx)("input",{style:{display:"none"},accept:".json",id:"contained-button-import",type:"file",onChange:e.handlerLoadData}),Object(f.jsx)("label",{htmlFor:"contained-button-import",children:Object(f.jsx)(Ce,{icon:Object(f.jsx)(xe.a,{fontSize:"small"}),text:"Load from file"})}),Object(f.jsx)(Ce,{onClick:function(){return e.handlerLoadData(null)},icon:Object(f.jsx)(ye.a,{fontSize:"small"}),text:"Load from cookies"}),Object(f.jsx)(Re,{}),Object(f.jsx)(Ce,{onClick:function(){return e.handlerSaveData(!1)},icon:Object(f.jsx)(ve.a,{fontSize:"small"}),text:"Save as file"}),Object(f.jsx)(Ce,{onClick:function(){return e.handlerSaveData(!0)},icon:Object(f.jsx)(ye.a,{fontSize:"small"}),text:"Save as cookies"}),Object(f.jsx)(Re,{}),Object(f.jsx)(Ce,{onClick:function(){return e.handlerResetData(!1)},icon:Object(f.jsx)(A.a,{fontSize:"small"}),text:"Delete current session"}),Object(f.jsx)(Ce,{onClick:function(){return e.handlerResetData(!0)},icon:Object(f.jsx)(A.a,{fontSize:"small"}),text:"Delete cookies"})]}),Object(f.jsxs)(Z,{children:[Object(f.jsx)(W,{endIcon:Object(f.jsx)(ke.a,{}),onClick:function(){return window.open("https://www.paypal.com/paypalme/StephaneBranly","_blank")},text:"Sponsor"}),Object(f.jsx)(W,{endIcon:Object(f.jsx)(Ne.a,{}),onClick:function(){return window.open("https://github.com/StephaneBranly/game-ranking","_blank")},text:"GitHub"}),Object(f.jsx)("div",{ref:i,children:Object(f.jsx)(W,{startIcon:Object(f.jsx)(ye.a,{}),onClick:function(){return s(!0)},text:"Data",className:"data-menu"})})]})]})}function De(e){return Object(f.jsxs)("div",{children:[Object(f.jsx)(we,Object(i.a)({},e)),Object(f.jsx)(ge,{})]})}a(429);var Ee=a(242),Pe=a.n(Ee);function _e(e){return Object(f.jsx)("div",{className:"player-header",children:Object(f.jsx)(W,{startIcon:Object(f.jsx)(Pe.a,{}),onClick:function(){return function(){var t=a(430)(),n={uuid:Object(D.uuid)(),username:"New Player",color:t};e.setPlayers(e.players.concat(n)),e.setCurrentPlayer({player:n,edit:!0})}()},text:"Add a new player"})})}a(431);function Fe(e){return Object(f.jsx)("div",{className:"player-card ".concat(e.isSelected?"selected":""),onClick:function(){return e.setCurrentPlayer({player:e.player,edit:!1})},children:Object(f.jsx)(P,{color:e.player.color,label:g(e.player)})})}a(432);var Ge=a(247);function Me(e){var t=r.a.useState(e.player),a=Object(d.a)(t,2),n=a[0],c=a[1];return Object(f.jsx)(Q,{open:!0,onClose:function(){e.setEditMode(!1)},title:"Edit player",content:Object(f.jsxs)("div",{className:"vertical-centered gap-10",children:[Object(f.jsx)(re,{label:"Username",type:"text",value:n.username,onChange:function(e){return c(Object(i.a)(Object(i.a)({},n),{},{username:e.target.value}))}}),Object(f.jsx)(Ge.a,{color:n.color,onChangeComplete:function(e){return c(Object(i.a)(Object(i.a)({},n),{},{color:e.hex}))},disableAlpha:!0,className:"color-picker"})]}),actions:Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(W,{onClick:function(){return e.setEditMode(!1)},text:"Cancel"}),Object(f.jsx)(W,{onClick:function(){e.handleChangePlayer(n),e.setEditMode(!1)},text:"Update",style:{color:"#0DF505",borderColor:"#0DF505"}})]})})}function Ae(e){var t=r.a.useState(e.edit),a=Object(d.a)(t,2),n=a[0],c=a[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"player-complete-card",children:[Object(f.jsx)(W,{onClick:function(){return c(!0)},startIcon:Object(f.jsx)(M.a,{})}),Object(f.jsx)("p",{children:e.player.username})]}),n&&Object(f.jsx)(Me,{setEditMode:c,handleChangePlayer:function(t){e.changePlayerData(t,t.uuid)},player:e.player})]})}function Ie(e){var t=Object(n.useState)({player:void 0,edit:!1}),a=Object(d.a)(t,2),r=a[0],c=a[1],s=function(t,a){var n=e.players;n.map((function(e){return e.uuid===a?Object.assign(e,t):e})),e.setPlayers(n)};return Object(f.jsx)(Q,{open:!0,title:"Players",content:function(){return Object(f.jsxs)("div",{className:"players",children:[Object(f.jsx)(_e,{players:e.players,setPlayers:e.setPlayers,setCurrentPlayer:c}),Object(f.jsx)("div",{className:"players-cards",children:(t=e.players,t.map((function(t){return Object(f.jsx)(Fe,{player:t,games:e.games,changePlayerData:s,setCurrentPlayer:c,isSelected:r.player===t})})))}),r.player&&Object(f.jsx)(Ae,{player:r.player,edit:r.edit,changePlayerData:s,addNotification:e.addNotification,setCurrentPlayer:c})]});var t}(),actions:Object(f.jsx)(f.Fragment,{}),onClose:function(){return e.setPlayersOpen(!1)}})}var Ue=function(){var e=r.a.useState([]),t=Object(d.a)(e,2),c=t[0],s=t[1],l=r.a.useState([]),j=Object(d.a)(l,2),m=j[0],p=j[1],O=r.a.useState({open:!1}),g=Object(d.a)(O,2),x=g[0],y=g[1],v=r.a.useState(!1),k=Object(d.a)(v,2),N=k[0],C=k[1],R=r.a.useState(!1),w=Object(d.a)(R,2),D=w[0],E=w[1];Object(n.useEffect)((function(){P(null)}),[]);var P=function(e){if(e)try{var t;e.preventDefault();var a=new FileReader;a.onload=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(a=t.target)||void 0===a?void 0:a.result)&&(n=JSON.parse(t.target.result),s(n.players),r=n.games.map((function(e){return S(e)})),p(r),_("Data correctly loaded","success"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(null===(t=e.target)||void 0===t?void 0:t.files)&&a.readAsText(e.target.files[0])}catch(c){_("Error when loading data","error")}else if(localStorage.getItem("data")){var n=JSON.parse(localStorage.getItem("data"));s(n.players);var r=n.games.map((function(e){return S(e)}));p(r),_("Data correctly loaded","success")}else _("Data not found in cookies","warning")},_=function(e,t){y({open:!0,text:e,severity:t||void 0})},F={notification:x,setNotification:y},G={handlerSaveData:function(e){var t=JSON.stringify({players:c,games:m.map((function(e){return{uuid:e.uuid,gamename:e.gamename,results:e.results,algorithmSettings:e.algorithmSettings}}))});if(e)try{localStorage.setItem("data",t),_("Data saved as cookies","success")}catch(s){_("Error when saving as cookies","error")}else{var n=a(465),r=new Blob([t],{type:"application/json"});n.saveAs(r,"save_game-ranking.json")}},handlerLoadData:P,handlerResetData:function(e){e?(localStorage.removeItem("data"),_("Cookie correctly removed","success")):(s([]),p([]),_("Current session correctly reinitiliazed","success"))}};return Object(f.jsxs)("div",{className:"app",children:[Object(f.jsx)(b,{setSettingsOpen:C,setPlayersOpen:E}),Object(f.jsx)(he,{games:m,setGames:p,players:c,addNotification:_}),D&&Object(f.jsx)(Ie,{players:c,setPlayers:s,games:m,addNotification:_,setPlayersOpen:E}),Object(f.jsx)(h,Object(i.a)({},F)),Object(f.jsx)(Q,{open:N,title:"Settings",content:Object(f.jsx)(De,Object(i.a)({},G)),onClose:function(){return C(!1)}})]})};s.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(Ue,{})}),document.getElementById("root"))}},[[466,1,2]]]);
//# sourceMappingURL=main.d3895516.chunk.js.map